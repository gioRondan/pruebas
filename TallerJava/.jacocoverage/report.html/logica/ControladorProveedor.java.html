<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ControladorProveedor.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">JaCoCoverage analysis of project &quot;TallerJava&quot; (powered by JaCoCo from EclEmma)</a> &gt; <a href="index.source.html" class="el_package">logica</a> &gt; <span class="el_source">ControladorProveedor.java</span></div><h1>ControladorProveedor.java</h1><pre class="source lang-java linenums">package logica;

import java.util.*;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.JOptionPane;


/**
 *
 * @author Juan
 */
<span class="fc" id="L13">public class ControladorProveedor implements IControladorProveedor{</span>
<span class="fc" id="L14">    private Set&lt;String&gt; imagenServicio = new HashSet();</span>
<span class="fc" id="L15">    private String destinoServicio = &quot;&quot;;</span>
<span class="fc" id="L16">    private String origenServicio = &quot;&quot;;</span>
<span class="fc" id="L17">    private Set&lt;String&gt; categoriasServicio = new HashSet();</span>
<span class="fc" id="L18">    private String servicio = &quot;&quot;;</span>
<span class="fc" id="L19">    private String proveedor = &quot;&quot;;</span>
<span class="fc" id="L20">    private String descripcionServicio = &quot;&quot;;</span>
<span class="fc" id="L21">    private float precioServicio = 0;</span>
<span class="fc" id="L22">    private String categoria = &quot;&quot;;</span>
<span class="fc" id="L23">    private String nomCategoria = &quot;&quot;;</span>
<span class="fc" id="L24">    private String nomPadre = &quot;&quot;;</span>
    private String imagenProveedor;
    
    private void liberarMemoria(){
        
<span class="nc" id="L29">    }</span>
    @Override
    public void ingresarImagenServicio(String imagen){
<span class="fc" id="L32">        this.imagenServicio.add(imagen);</span>
<span class="fc" id="L33">    }</span>
    @Override
    public void ingresarDestinoServicio(String  destino ){
<span class="fc" id="L36">        this.destinoServicio = destino;</span>
<span class="fc" id="L37">    }</span>
    @Override
    public Set&lt;DataCiudad&gt; listarCiudades(){
<span class="fc" id="L40">        ManejadorCiudad mCi = ManejadorCiudad.getInstance();</span>
<span class="fc" id="L41">        return mCi.getDataCiudades();//falta implementar manejadorciudad</span>
    }
    @Override
    public void ingresarCategoriaServicio( String categoria){
<span class="fc" id="L45">        this.categoriasServicio.add(categoria);</span>
<span class="fc" id="L46">    }</span>
    @Override
    public Set&lt;DataCategoria&gt; listarCategorias(){
<span class="fc" id="L49">        ManejadorCategoria mCa = ManejadorCategoria.getInstance();</span>
<span class="fc" id="L50">        return mCa.getDataCategorias();//falta implementar manejadorcategoria</span>
    }
    @Override
    public void altaServicio(String nombre , String descripcion, int precio, String origen, String proveedor){
<span class="fc" id="L54">        Servicio ser = new Servicio(nombre, descripcion, precio);</span>
<span class="pc bpc" id="L55" title="1 of 2 branches missed.">        for (String im : imagenServicio){</span>
            try {
<span class="nc" id="L57">                ser.agregarImagen(im);</span>
<span class="nc" id="L58">            } catch (Exception ex) {</span>
<span class="nc" id="L59">                Logger.getLogger(ControladorProveedor.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L60">            }</span>
<span class="nc" id="L61">        }</span>
<span class="fc" id="L62">        ManejadorProveedor mPr = ManejadorProveedor.getInstance();</span>
<span class="fc" id="L63">        Proveedor prov = mPr.getProveedor(proveedor);</span>
<span class="nc" id="L64">        prov.asociarServicio(ser);</span>
        //asociar servicio a proveedor??????
<span class="nc" id="L66">        ManejadorCategoria mCa = ManejadorCategoria.getInstance();</span>
<span class="nc bnc" id="L67" title="All 2 branches missed.">        for(String cats : categoriasServicio){</span>
<span class="nc" id="L68">            Categoria cat = mCa.getCategoria(cats);</span>
<span class="nc" id="L69">            cat.setServicio(ser);</span>
<span class="nc" id="L70">            ser.agregarCategoria(cat);</span>
<span class="nc" id="L71">        }</span>
<span class="nc" id="L72">        ManejadorCiudad mCi = ManejadorCiudad.getInstance();</span>
<span class="nc" id="L73">        ser.asociarOrigen(mCi.getCiudad(origen));</span>
<span class="nc bnc" id="L74" title="All 2 branches missed.">        if (!destinoServicio.isEmpty()){</span>
<span class="nc" id="L75">            ser.asociarDestino(mCi.getCiudad(destinoServicio));</span>
        }
<span class="nc" id="L77">        liberarMemoria();</span>
<span class="nc" id="L78">    }</span>
    @Override
    public Set&lt;DataProveedor&gt; listarProveedores(){
<span class="fc" id="L81">        ManejadorProveedor mPr = ManejadorProveedor.getInstance();</span>
<span class="fc" id="L82">        return mPr.getDataProveedores();</span>
    }
    public void seleccionarCategoria(String categoria){
<span class="fc" id="L85">        this.categoria = categoria;</span>
<span class="fc" id="L86">    }</span>
    @Override
    public Set&lt;DataServicio&gt; listarServiciosXCategoria( String nomCategoria){
<span class="fc" id="L89">        ManejadorCategoria mCa = ManejadorCategoria.getInstance();</span>
<span class="fc" id="L90">        Categoria cat = mCa.getCategoria(categoria);</span>
<span class="nc" id="L91">        return cat.getDataServicios();</span>
    }
    @Override
    public void ingresarNombreCategoria(String nombre){
<span class="fc" id="L95">        this.nomCategoria = nombre;</span>
<span class="fc" id="L96">    }</span>
    @Override
    public void seleccionarPadre(String nombre){
<span class="fc" id="L99">        this.nomPadre = nombre;</span>
<span class="fc" id="L100">    }    </span>
    @Override
    public void altaCategoria(){
<span class="fc" id="L103">        ManejadorCategoria mCa = ManejadorCategoria.getInstance();</span>
<span class="fc" id="L104">        mCa.crearCategoria(this.nomCategoria,this.nomPadre);</span>
<span class="fc" id="L105">    }</span>
    @Override
    public Set&lt;DataServicio&gt; listarServiciosXProveedor( String nomProveedor){
<span class="fc" id="L108">        ManejadorProveedor mPr = ManejadorProveedor.getInstance();</span>
<span class="fc" id="L109">        Proveedor prov = mPr.getProveedor(nomProveedor);//nickname</span>
<span class="fc" id="L110">        this.proveedor = nomProveedor;//para que esta linea ?</span>
<span class="nc" id="L111">        return prov.getDataServicios();</span>
    }
    public void seleccionarServicio(String nomServicio){
<span class="fc" id="L114">        this.servicio = nomServicio;</span>
<span class="fc" id="L115">    }</span>
    @Override
    public void altaPromocion( String nomProveedor,Set&lt;String&gt; ser, String nombre, int descuento){
<span class="fc" id="L118">        ManejadorProveedor mPr = ManejadorProveedor.getInstance();</span>
<span class="fc" id="L119">        Proveedor prov = mPr.getProveedor(nomProveedor);//nickname</span>
<span class="nc" id="L120">        Iterator&lt;String&gt; itera = ser.iterator();</span>
<span class="nc" id="L121">        int totalPrecio=0;</span>
<span class="nc" id="L122">        Promocion p = new Promocion(nombre, descuento, totalPrecio);</span>
<span class="nc" id="L123">        prov.asociarPromocion(p);</span>
<span class="nc bnc" id="L124" title="All 2 branches missed.">        while (itera.hasNext()) {</span>
            //recorro los servicos a agregar y voy calculando el precio de la promocion sin el descuento
<span class="nc" id="L126">            Servicio s = prov.getServicio(itera.next()); </span>
<span class="nc" id="L127">            totalPrecio += s.getPrecio();</span>
<span class="nc" id="L128">            p.agregarServicio(s);</span>
<span class="nc" id="L129">        }</span>
<span class="nc" id="L130">        totalPrecio=(int)(totalPrecio * (0.1*descuento));//aplico el descuento</span>
<span class="nc" id="L131">        p.setPrecioTotal(totalPrecio);//Seteo el precio total con el descuento aplicado </span>
<span class="nc" id="L132">    }</span>
    @Override
    public void ingresarDescripcionServicio( String desc){
<span class="fc" id="L135">        this.descripcionServicio = desc;</span>
<span class="fc" id="L136">    }</span>
    @Override
    public void ingresarPrecioServicio(int precio){
<span class="fc" id="L139">        this.precioServicio = precio;</span>
<span class="fc" id="L140">    }</span>
    @Override
    public void ingresarOrigenServicio( String origen){
<span class="fc" id="L143">        this.origenServicio = origen;</span>
<span class="fc" id="L144">    }</span>
    @Override
    public void modificarServicio(){
<span class="fc" id="L147">        ManejadorProveedor mPr = ManejadorProveedor.getInstance();</span>
<span class="fc" id="L148">        Proveedor prov = mPr.getProveedor(proveedor);</span>
<span class="nc" id="L149">        Servicio ser = prov.getServicio(servicio);</span>
<span class="nc bnc" id="L150" title="All 2 branches missed.">        if (!descripcionServicio.isEmpty()){</span>
<span class="nc" id="L151">            ser.setDesc(descripcionServicio);</span>
        }
<span class="nc bnc" id="L153" title="All 2 branches missed.">        for(String im : imagenServicio){</span>
            try {
<span class="nc" id="L155">                ser.agregarImagen(im);//revisar</span>
<span class="nc" id="L156">            } catch (Exception ex) {</span>
<span class="nc" id="L157">                Logger.getLogger(ControladorProveedor.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L158">            }</span>
<span class="nc" id="L159">        }</span>
<span class="nc bnc" id="L160" title="All 2 branches missed.">        if (precioServicio != 0){</span>
<span class="nc" id="L161">            ser.setPrecio(precioServicio);</span>
        }
<span class="nc bnc" id="L163" title="All 2 branches missed.">        if (!origenServicio.isEmpty()){</span>
<span class="nc" id="L164">            ManejadorCiudad mCi = ManejadorCiudad.getInstance();</span>
<span class="nc" id="L165">            ser.asociarOrigen(mCi.getCiudad(origenServicio));</span>
        }
<span class="nc bnc" id="L167" title="All 2 branches missed.">        if (!destinoServicio.isEmpty()){</span>
<span class="nc" id="L168">            ManejadorCiudad mCi = ManejadorCiudad.getInstance();</span>
<span class="nc" id="L169">            ser.asociarDestino(mCi.getCiudad(destinoServicio));</span>
        }
<span class="nc bnc" id="L171" title="All 2 branches missed.">        for(String im : imagenServicio){</span>
            try {
<span class="nc" id="L173">                ser.agregarImagen(im);//revisar</span>
<span class="nc" id="L174">            } catch (Exception ex) {</span>
<span class="nc" id="L175">                Logger.getLogger(ControladorProveedor.class.getName()).log(Level.SEVERE, null, ex);</span>
<span class="nc" id="L176">            }</span>
<span class="nc" id="L177">        }</span>
<span class="nc bnc" id="L178" title="All 2 branches missed.">        for(String cats : categoriasServicio){</span>
<span class="nc" id="L179">            ManejadorCategoria mCa = ManejadorCategoria.getInstance();</span>
<span class="nc" id="L180">            Categoria cat = mCa.getCategoria(cats);//hay que eliminar las categorias anteriores?</span>
<span class="nc" id="L181">            cat.setServicio(ser);</span>
<span class="nc" id="L182">            ser.agregarCategoria(cat);</span>
<span class="nc" id="L183">        }</span>
<span class="nc" id="L184">        liberarMemoria();</span>
<span class="nc" id="L185">    }</span>
    @Override
    public List&lt;DataEmpresa&gt; listarEmpresas(){
<span class="fc" id="L188">        ManejadorEmpresa mEmp = ManejadorEmpresa.getInstance();</span>
<span class="fc" id="L189">        return mEmp.getDataEmpresas();</span>
    }
    /*public List&lt;DataEmpresa&gt; listarEmpresas(){
      //NO ESTA ECHA ES UNA PROEBA NADA MAS 
        List&lt;DataEmpresa&gt; dts ; 
        dts = new ArrayList&lt;&gt;();        
        DataEmpresa dte = new DataEmpresa(&quot;Antel&quot;,&quot;www.antel.com.uy&quot;);
        Boolean ok = dts.add(dte);
       
        dte = new DataEmpresa(&quot;Coonaprole&quot;, &quot;www.coonaprole.com.uy&quot;);
        dts.add(dte);
       
        return dts;
    }*/
    
    @Override
    public void altaProveedor( String nick, String nombre, String  apellido,String email ,Date fechaNac, String imagen, String nombreEmp, String linkEmp) throws Exception{
        
       
<span class="fc" id="L208">        ManejadorProveedor mPr = ManejadorProveedor.getInstance();</span>
       
<span class="fc" id="L210">       mPr.unicidadNick(nick);//bomba!!!!!!!!!!!!</span>
<span class="fc" id="L211">        mPr.unicidadEmail(email);//bomba!!!!!!!!!!!!</span>
   
<span class="pc bpc" id="L213" title="5 of 10 branches missed.">       if ((nick.isEmpty()) || (nombre.isEmpty()) || (apellido.isEmpty()) || (email.isEmpty())  || (nombreEmp.isEmpty())){</span>
<span class="nc" id="L214">            throw new Exception(&quot;los datos ingresados no son correctos&quot;);</span>
        }else{
<span class="fc" id="L216">            Proveedor prov = new Proveedor(nick, nombre, apellido, email, fechaNac, imagen);</span>
<span class="fc" id="L217">            ManejadorEmpresa mEmp =  ManejadorEmpresa.getInstance();</span>
<span class="fc" id="L218">            Empresa emp = mEmp.getEmpresa(nombreEmp);</span>
<span class="pc bpc" id="L219" title="1 of 2 branches missed.">            if (emp == null){</span>
<span class="fc" id="L220">                emp = new Empresa(nombreEmp, linkEmp);</span>
<span class="fc" id="L221">                mEmp.addEmpresa(emp);</span>
            }
<span class="fc" id="L223">            prov.asociarEmpresa(emp);</span>
<span class="fc" id="L224">            mPr.addProveedor(prov);</span>
        }
<span class="fc" id="L226">    }</span>
    @Override
    public Set&lt;DataPromocion&gt; listarPromocionesXProveedor( String nomProveedor){
<span class="fc" id="L229">        ManejadorProveedor mPr = ManejadorProveedor.getInstance();</span>
<span class="fc" id="L230">        Proveedor prov = mPr.getProveedor(proveedor);</span>
<span class="nc" id="L231">        return prov.getDataPromociones();</span>
    }
    @Override
    public DataInfoServicio verInfoServicio( String nomServicio){
<span class="fc" id="L235">        ManejadorProveedor mPr = ManejadorProveedor.getInstance();</span>
<span class="fc" id="L236">        Proveedor prov = mPr.getProveedor(proveedor);</span>
<span class="nc" id="L237">        Servicio ser = prov.getServicio(nomServicio);</span>
<span class="nc" id="L238">        return ser.getDataInfoServicio();</span>
    }
    @Override
    public DataInfoProveedor verInfoProveedor( String nomProveedor){
<span class="fc" id="L242">        ManejadorProveedor mPr = ManejadorProveedor.getInstance();</span>
<span class="fc" id="L243">        Proveedor prov = mPr.getProveedor(nomProveedor);</span>
<span class="nc" id="L244">        return prov.getDataInfoProveedor();</span>
    }
    @Override
    public void ingresarImagen(String imagen) {
<span class="fc" id="L248">        this.imagenProveedor = imagen;</span>
<span class="fc" id="L249">    }</span>

    
    @Override
    public DataInfoPromocion verInfoPromocion(String nickproveedor, String nomPromocion) {
<span class="fc" id="L254">        ManejadorProveedor m = ManejadorProveedor.getInstance();</span>
<span class="fc" id="L255">        Proveedor p = m.getProveedor(nickproveedor);</span>
<span class="nc" id="L256">        Promocion promo = p.getPromocion(nomPromocion);</span>
        
<span class="nc" id="L258">        return promo.getDataInfoPromocion();</span>
    }
}

</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>